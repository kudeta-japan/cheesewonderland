<!doctype html>
<html lang="ja">
<head>
  <!-- =============================================
    Cheese Wonderland ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆï¼ˆFormspreeç‰ˆãƒ»A/Bæ§‹æˆï¼‹é€²è¡Œãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼‹ãƒã‚¹ã‚³ãƒƒãƒˆå¿œæ´ï¼‰
    å¤‰æ›´ç‚¹ï¼š
      - ãƒ¯ã‚¯ãƒ¯ã‚¯æ¼”å‡ºï¼šãƒãƒ¼ã‚ºã®ãƒã‚¹ã‚³ãƒƒãƒˆã€Œãƒãƒ¼ã‚¾ã€ãŒå¿œæ´ï¼ˆå¹ãå‡ºã—/ã‚¢ãƒ‹ãƒ¡ï¼‰
      - é€²è¡Œãƒ¡ãƒ¼ã‚¿ãƒ¼å¼·åŒ–ï¼šæ®‹ã‚Šå•æ•°ï¼†%è¡¨ç¤ºã€ãƒãƒ¼ã‚¾ãŒãƒãƒ¼ä¸Šã‚’ç§»å‹•
      - ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†æ™‚ã«ã‚³ãƒ³ãƒ•ã‚§ãƒƒãƒ†ã‚£ï¼ˆğŸ§€âœ¨ï¼‰æ¼”å‡º
      - è§¦æ„ŸUIï¼šé¸æŠæ™‚ã«ãƒãƒƒãƒ—/ã‚°ãƒ­ãƒ¼ã€ãƒœã‚¿ãƒ³ã«è»½ã„è·³ã­
      - æ§‹æˆã¯å‰å›åŒæ§˜ï¼šA.å…¨ä½“è©•ä¾¡ â†’ B.å„ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ â†’ é †ä½
      - ä¸è¦é …ç›®ï¼ˆæ°å/ãƒ¡ãƒ¼ãƒ«/ãŠä½ã¾ã„/æ²è¼‰å¯å¦ï¼‰ã¯å¼•ãç¶šãéè¡¨ç¤º
  ============================================== -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cheese Wonderland ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</title>
  <meta name="description" content="Cheese Wonderland ã”å‚åŠ è€…ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆï¼ˆæ‰€è¦2ã€œ3åˆ†ãƒ»åŒ¿åï¼‰" />
  <style>
    :root{
      --bg:#090b11; --fg:#f8f8fb; --muted:#b9bfd1; --brand:#ffd54d; --brand2:#ffb300; --card:#121520; --ok:#31c48d; --pink:#ff82c3;
      --accent:#78d3ff; --glow:0 0 0 0 rgba(255,213,77,.0);
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", Meiryo, sans-serif; background:
      radial-gradient(1200px 800px at 70% -20%, rgba(255,213,77,.10), transparent),
      radial-gradient(1000px 600px at 10% 110%, rgba(120,211,255,.08), transparent),
      var(--bg); color:var(--fg);}
    .wrap{max-width:920px; margin:0 auto; padding:28px 18px 64px;}
    header{display:flex; align-items:flex-start; justify-content:space-between; gap:16px; margin-bottom:12px}
    .brand{display:flex; align-items:center; gap:12px}
    .logo{width:44px; height:44px; border-radius:12px; background:conic-gradient(from 20deg,var(--brand),var(--brand2)); box-shadow:0 6px 18px rgba(255,181,0,.25);}
    h1{font-size: clamp(1.2rem, 2.4vw, 1.8rem); margin:0}
    .muted{color:var(--muted); font-size:.95rem}

    /* mascot */
    .mascot{position:relative; display:flex; align-items:center; gap:12px}
    .mascot svg{width:86px; filter: drop-shadow(0 10px 28px rgba(255,179,0,.22)); animation: floaty 4s ease-in-out infinite;}
    @keyframes floaty{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}
    .bubble{position:relative; background:#101528; border:1px solid rgba(255,255,255,.10); padding:10px 12px; border-radius:14px; max-width:280px;}
    .bubble:after{content:""; position:absolute; left:-8px; top:22px; border:8px solid transparent; border-right-color:#101528; filter:drop-shadow(-1px 0 0 rgba(255,255,255,.1))}
    .bubble strong{color:#ffe082}

    .card{background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.0)); border:1px solid rgba(255,255,255,.06); box-shadow:0 10px 30px rgba(0,0,0,.25); border-radius:22px; padding:18px; margin:16px 0;}

    /* progress */
    .progress-wrap{position:relative;}
    .bar{height:10px; background:#20242c; border-radius:999px; overflow:hidden;}
    .bar>i{display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--brand),var(--brand2)); box-shadow:0 0 22px rgba(255,179,0,.45) inset; transition:width .35s ease}
    .bar .buddy{position:absolute; top:50%; transform:translate(-50%,-50%); width:24px; height:24px; border-radius:50%; background:radial-gradient(circle at 30% 30%, #fff7c4, #ffcc33); box-shadow:0 8px 18px rgba(255,190,0,.35); border:2px solid #2a2210}
    .bar .buddy:after{content:"ğŸ§€"; position:absolute; inset:0; display:grid; place-items:center; font-size:14px}
    .progress-caption{display:flex; justify-content:space-between; align-items:center; margin-top:6px; font-size:.92rem; color:var(--muted)}

    /* inputs */
    .grid{display:grid; gap:12px}
    label{display:block; font-weight:700; margin:6px 0 8px}
    .help{color:var(--muted); font-size:.9rem}
    .opt{display:flex; gap:10px; flex-wrap:wrap}
    .opt input[type="radio"]{display:none}
    .opt label{border:1px solid rgba(255,255,255,.14); padding:12px 14px; border-radius:14px; cursor:pointer; background:#101217; transition:.15s transform, .2s box-shadow}
    .opt label:hover{transform:translateY(-1px)}
    .opt input:checked + label{outline:2px solid var(--brand); background:linear-gradient(180deg,rgba(255,213,77,.12),transparent); box-shadow:0 0 0 6px rgba(255,213,77,.10)}
    select{ width:100%; background:#101217; color:var(--fg); border:1px solid rgba(255,255,255,.12); border-radius:12px; padding:12px 14px; font-size:1rem; outline:none; }

    .btns{display:flex; gap:10px; flex-wrap:wrap}
    button{cursor:pointer; border:0; padding:12px 16px; border-radius:14px; font-weight:800; transition:transform .08s ease}
    .primary{background:linear-gradient(135deg,var(--brand),var(--brand2)); color:#202020}
    .ghost{background:transparent; color:var(--fg); border:1px solid rgba(255,255,255,.14)}
    button:active{transform:translateY(1px) scale(.99)}

    .section-badge{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; background:#101217; border:1px solid rgba(255,255,255,.12); font-size:.85rem; margin-bottom:8px}

    /* steps */
    .step{display:none}
    .step.active{display:block; animation: fadeIn .22s ease}
    @keyframes fadeIn{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)}}

    /* confetti */
    .confetti span{position:fixed; top:-10vh; left:50%; transform:translateX(-50%); font-size:18px; animation: fall 1.6s linear forwards;}
    @keyframes fall{to{transform:translateX(calc(-50% + var(--x))) translateY(110vh) rotate(720deg); opacity:0}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Cheese Wonderland ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</h1>
          <div class="muted">æ‰€è¦ <b>2ã€œ3åˆ†</b>ï¼åŒ¿åãƒ»ä¸€éƒ¨ä»»æ„</div>
        </div>
      </div>
      <div class="mascot" aria-live="polite">
        <!-- ğŸ§€ ãƒãƒ¼ã‚¾ï¼ˆSVGãƒã‚¹ã‚³ãƒƒãƒˆï¼‰ -->
        <svg viewBox="0 0 120 120" aria-hidden="true">
          <defs>
            <radialGradient id="g" cx="30%" cy="30%" r="70%">
              <stop offset="0%" stop-color="#fff7c4"/>
              <stop offset="100%" stop-color="#ffcc33"/>
            </radialGradient>
          </defs>
          <!-- body -->
          <polygon points="10,90 100,90 60,20" fill="url(#g)" stroke="#a67810" stroke-width="3"/>
          <!-- holes -->
          <circle cx="55" cy="60" r="6" fill="#f5b400" opacity=".8"/>
          <circle cx="70" cy="75" r="4" fill="#f5b400" opacity=".8"/>
          <circle cx="45" cy="80" r="3" fill="#f5b400" opacity=".8"/>
          <!-- face -->
          <circle cx="52" cy="58" r="3" fill="#2a2210"/>
          <circle cx="68" cy="58" r="3" fill="#2a2210"/>
          <path d="M52 68 Q60 72 68 68" stroke="#2a2210" stroke-width="3" fill="none"/>
          <!-- waving hand -->
          <g transform="translate(100,70)">
            <circle cx="0" cy="0" r="6" fill="#ffcc33" stroke="#a67810" stroke-width="2">
              <animateTransform attributeName="transform" type="rotate" values="-15;15;-15" dur="1.6s" repeatCount="indefinite"/>
            </circle>
          </g>
        </svg>
        <div class="bubble" id="bubble">ã‚ˆã†ã“ãï¼<strong>A</strong>ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã ã‚ˆã€‚<br>ã‚«ãƒ³ã‚¿ãƒ³ã ã‹ã‚‰ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ã¦ã­ğŸ§€</div>
      </div>
    </header>

    <div class="card">
      <div class="progress-wrap">
        <div class="bar"><i id="progress"></i><i class="buddy" id="buddy" style="left:0%"></i></div>
        <div class="progress-caption"><span id="captionLeft">ã¯ã˜ã‚ã«</span><span id="captionRight">0%</span></div>
      </div>

      <form id="form" class="grid" novalidate>
        <!-- ğŸ”’ honeypot for spam -->
        <input type="text" name="website" autocomplete="off" class="sr-only" tabindex="-1" aria-hidden="true">
        <input type="hidden" name="timestamp" id="timestamp">
        <input type="hidden" name="source" id="source">
        <input type="hidden" name="form_version" value="cw_v1.3_mascot">

        <!-- STEP A-1: æº€è¶³åº¦ -->
        <section class="step active" data-step="1">
          <div class="section-badge">A. å…¨ä½“è©•ä¾¡</div>
          <label>æœ¬æ—¥ã®æº€è¶³åº¦ï¼ˆ1ã€œ5ï¼‰</label>
          <div class="opt" role="radiogroup" aria-label="æº€è¶³åº¦">
            <input type="radio" id="csat1" name="csat" value="1" required><label for="csat1">1</label>
            <input type="radio" id="csat2" name="csat" value="2"><label for="csat2">2</label>
            <input type="radio" id="csat3" name="csat" value="3"><label for="csat3">3</label>
            <input type="radio" id="csat4" name="csat" value="4"><label for="csat4">4</label>
            <input type="radio" id="csat5" name="csat" value="5"><label for="csat5">5</label>
          </div>
          <p class="help">1=ä¸æº€ / 5=ã¨ã¦ã‚‚æº€è¶³</p>
          <div class="btns"><button type="button" class="primary" data-next>æ¬¡ã¸</button></div>
        </section>

        <!-- STEP A-2: å‹§ã‚ãŸã„åº¦ -->
        <section class="step" data-step="2">
          <div class="section-badge">A. å…¨ä½“è©•ä¾¡</div>
          <label>å‹äººã«å‹§ã‚ãŸã„åº¦ï¼ˆ1ã€œ5ï¼‰</label>
          <div class="opt" role="radiogroup" aria-label="å‹§ã‚ãŸã„åº¦">
            <input type="radio" id="nps1" name="nps" value="1" required><label for="nps1">1</label>
            <input type="radio" id="nps2" name="nps" value="2"><label for="nps2">2</label>
            <input type="radio" id="nps3" name="nps" value="3"><label for="nps3">3</label>
            <input type="radio" id="nps4" name="nps" value="4"><label for="nps4">4</label>
            <input type="radio" id="nps5" name="nps" value="5"><label for="nps5">5</label>
          </div>
          <div class="btns">
            <button type="button" class="ghost" data-prev>æˆ»ã‚‹</button>
            <button type="button" class="primary" data-next>æ¬¡ã¸</button>
          </div>
        </section>

        <!-- STEP A-3: æ¬¡å›å‚åŠ æ„å‘ -->
        <section class="step" data-step="3">
          <div class="section-badge">A. å…¨ä½“è©•ä¾¡</div>
          <label>æ¬¡å›ã‚‚å‚åŠ ã—ãŸã„ã§ã™ã‹ï¼Ÿ</label>
          <div class="opt">
            <input type="radio" id="rejoin_yes" name="rejoin" value="ã¯ã„" required><label for="rejoin_yes">ã¯ã„</label>
            <input type="radio" id="rejoin_maybe" name="rejoin" value="æœªå®š"><label for="rejoin_maybe">æœªå®š</label>
            <input type="radio" id="rejoin_no" name="rejoin" value="ã„ã„ãˆ"><label for="rejoin_no">ã„ã„ãˆ</label>
          </div>
          <div class="btns">
            <button type="button" class="ghost" data-prev>æˆ»ã‚‹</button>
            <button type="button" class="primary" data-next>æ¬¡ã¸</button>
          </div>
        </section>

        <!-- STEP A-4: ä¾¡æ ¼æ„Ÿ -->
        <section class="step" data-step="4">
          <div class="section-badge">A. å…¨ä½“è©•ä¾¡</div>
          <label>ä¾¡æ ¼ã®ç´å¾—æ„Ÿ</label>
          <div class="opt">
            <input type="radio" id="price1" name="price_fairness" value="é«˜ã™ãã‚‹" required><label for="price1">é«˜ã™ãã‚‹</label>
            <input type="radio" id="price2" name="price_fairness" value="ã‚„ã‚„é«˜ã„"><label for="price2">ã‚„ã‚„é«˜ã„</label>
            <input type="radio" id="price3" name="price_fairness" value="ã¡ã‚‡ã†ã©ã‚ˆã„"><label for="price3">ã¡ã‚‡ã†ã©ã‚ˆã„</label>
            <input type="radio" id="price4" name="price_fairness" value="ã‚„ã‚„å®‰ã„"><label for="price4">ã‚„ã‚„å®‰ã„</label>
            <input type="radio" id="price5" name="price_fairness" value="å®‰ã™ãã‚‹"><label for="price5">å®‰ã™ãã‚‹</label>
          </div>
          <div class="btns">
            <button type="button" class="ghost" data-prev>æˆ»ã‚‹</button>
            <button type="button" class="primary" data-next>æ¬¡ã¸</button>
          </div>
        </section>

        <!-- STEP B-1ã€œB-5: å„ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="step" data-step="5">
          <div class="section-badge">B. å„ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³</div>
          <label>ãƒ©ã‚¯ãƒ¬ãƒƒãƒˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼ˆ1ã€œ5ï¼‰</label>
          <div class="opt" role="radiogroup">
            <input type="radio" id="rac1" name="raclette_slider" value="1" required><label for="rac1">1</label>
            <input type="radio" id="rac2" name="raclette_slider" value="2"><label for="rac2">2</label>
            <input type="radio" id="rac3" name="raclette_slider" value="3"><label for="rac3">3</label>
            <input type="radio" id="rac4" name="raclette_slider" value="4"><label for="rac4">4</label>
            <input type="radio" id="rac5" name="raclette_slider" value="5"><label for="rac5">5</label>
          </div>
          <div class="btns"><button type="button" class="ghost" data-prev>æˆ»ã‚‹</button><button type="button" class="primary" data-next>æ¬¡ã¸</button></div>
        </section>

        <section class="step" data-step="6">
          <div class="section-badge">B. å„ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³</div>
          <label>ã‚·ã‚«ã‚´ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ«ï¼ˆ1ã€œ5ï¼‰</label>
          <div class="opt" role="radiogroup">
            <input type="radio" id="cwf1" name="chicago_waterfall" value="1" required><label for="cwf1">1</label>
            <input type="radio" id="cwf2" name="chicago_waterfall" value="2"><label for="cwf2">2</label>
            <input type="radio" id="cwf3" name="chicago_waterfall" value="3"><label for="cwf3">3</label>
            <input type="radio" id="cwf4" name="chicago_waterfall" value="4"><label for="cwf4">4</label>
            <input type="radio" id="cwf5" name="chicago_waterfall" value="5"><label for="cwf5">5</label>
          </div>
          <div class="btns"><button type="button" class="ghost" data-prev>æˆ»ã‚‹</button><button type="button" class="primary" data-next>æ¬¡ã¸</button></div>
        </section>

        <section class="step" data-step="7">
          <div class="section-badge">B. å„ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³</div>
          <label>ãƒ¡ãƒ«ãƒ†ã‚£ãƒ‡ã‚£ãƒƒãƒ—ãƒãƒƒãƒˆï¼ˆãƒãƒ¼ã‚ºãƒ•ã‚©ãƒ³ãƒ‡ãƒ¥ï¼‰ï¼ˆ1ã€œ5ï¼‰</label>
          <div class="opt" role="radiogroup">
            <input type="radio" id="mdp1" name="melty_dip_pot" value="1" required><label for="mdp1">1</label>
            <input type="radio" id="mdp2" name="melty_dip_pot" value="2"><label for="mdp2">2</label>
            <input type="radio" id="mdp3" name="melty_dip_pot" value="3"><label for="mdp3">3</label>
            <input type="radio" id="mdp4" name="melty_dip_pot" value="4"><label for="mdp4">4</label>
            <input type="radio" id="mdp5" name="melty_dip_pot" value="5"><label for="mdp5">5</label>
          </div>
          <div class="btns"><button type="button" class="ghost" data-prev>æˆ»ã‚‹</button><button type="button" class="primary" data-next>æ¬¡ã¸</button></div>
        </section>

        <section class="step" data-step="8">
          <div class="section-badge">B. å„ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³</div>
          <label>ãƒãƒ¼ã‚ºãƒ”ã‚¶ãƒ©ãƒœï¼ˆ1ã€œ5ï¼‰</label>
          <div class="opt" role="radiogroup">
            <input type="radio" id="cpl1" name="cheese_pizza_lab" value="1" required><label for="cpl1">1</label>
            <input type="radio" id="cpl2" name="cheese_pizza_lab" value="2"><label for="cpl2">2</label>
            <input type="radio" id="cpl3" name="cheese_pizza_lab" value="3"><label for="cpl3">3</label>
            <input type="radio" id="cpl4" name="cheese_pizza_lab" value="4"><label for="cpl4">4</label>
            <input type="radio" id="cpl5" name="cheese_pizza_lab" value="5"><label for="cpl5">5</label>
          </div>
          <div class="btns"><button type="button" class="ghost" data-prev>æˆ»ã‚‹</button><button type="button" class="primary" data-next>æ¬¡ã¸</button></div>
        </section>

        <section class="step" data-step="9">
          <div class="section-badge">B. å„ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³</div>
          <label>ã‚¨ã‚¹ãƒ—ãƒ¼ãƒãƒã‚¹ã‚¯ï¼ˆ1ã€œ5ï¼‰</label>
          <div class="opt" role="radiogroup">
            <input type="radio" id="eb1" name="espuma_basque" value="1" required><label for="eb1">1</label>
            <input type="radio" id="eb2" name="espuma_basque" value="2"><label for="eb2">2</label>
            <input type="radio" id="eb3" name="espuma_basque" value="3"><label for="eb3">3</label>
            <input type="radio" id="eb4" name="espuma_basque" value="4"><label for="eb4">4</label>
            <input type="radio" id="eb5" name="espuma_basque" value="5"><label for="eb5">5</label>
          </div>
          <div class="btns"><button type="button" class="ghost" data-prev>æˆ»ã‚‹</button><button type="button" class="primary" data-next>æ¬¡ã¸</button></div>
        </section>

        <!-- STEP B-6: é †ä½ -->
        <section class="step" data-step="10">
          <div class="section-badge">B. å„ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³</div>
          <label>ãŠæ°—ã«å…¥ã‚Šã®é †ä½ã‚’é¸ã‚“ã§ãã ã•ã„ï¼ˆé‡è¤‡ä¸å¯ï¼‰</label>
          <div class="grid">
            <div>
              <span class="help">1ä½</span>
              <select id="rank1" name="favorite_rank_1" required>
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                <option>ãƒ©ã‚¯ãƒ¬ãƒƒãƒˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼</option>
                <option>ã‚·ã‚«ã‚´ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ«</option>
                <option>ãƒ¡ãƒ«ãƒ†ã‚£ãƒ‡ã‚£ãƒƒãƒ—ãƒãƒƒãƒˆï¼ˆãƒãƒ¼ã‚ºãƒ•ã‚©ãƒ³ãƒ‡ãƒ¥ï¼‰</option>
                <option>ãƒãƒ¼ã‚ºãƒ”ã‚¶ãƒ©ãƒœ</option>
                <option>ã‚¨ã‚¹ãƒ—ãƒ¼ãƒãƒã‚¹ã‚¯</option>
              </select>
            </div>
            <div>
              <span class="help">2ä½</span>
              <select id="rank2" name="favorite_rank_2" required>
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                <option>ãƒ©ã‚¯ãƒ¬ãƒƒãƒˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼</option>
                <option>ã‚·ã‚«ã‚´ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ«</option>
                <option>ãƒ¡ãƒ«ãƒ†ã‚£ãƒ‡ã‚£ãƒƒãƒ—ãƒãƒƒãƒˆï¼ˆãƒãƒ¼ã‚ºãƒ•ã‚©ãƒ³ãƒ‡ãƒ¥ï¼‰</option>
                <option>ãƒãƒ¼ã‚ºãƒ”ã‚¶ãƒ©ãƒœ</option>
                <option>ã‚¨ã‚¹ãƒ—ãƒ¼ãƒãƒã‚¹ã‚¯</option>
              </select>
            </div>
            <div>
              <span class="help">3ä½</span>
              <select id="rank3" name="favorite_rank_3" required>
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                <option>ãƒ©ã‚¯ãƒ¬ãƒƒãƒˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼</option>
                <option>ã‚·ã‚«ã‚´ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ«</option>
                <option>ãƒ¡ãƒ«ãƒ†ã‚£ãƒ‡ã‚£ãƒƒãƒ—ãƒãƒƒãƒˆï¼ˆãƒãƒ¼ã‚ºãƒ•ã‚©ãƒ³ãƒ‡ãƒ¥ï¼‰</option>
                <option>ãƒãƒ¼ã‚ºãƒ”ã‚¶ãƒ©ãƒœ</option>
                <option>ã‚¨ã‚¹ãƒ—ãƒ¼ãƒãƒã‚¹ã‚¯</option>
              </select>
            </div>
          </div>
          <div class="btns"><button type="button" class="ghost" data-prev>æˆ»ã‚‹</button><button type="submit" class="primary">é€ä¿¡ã™ã‚‹</button></div>
        </section>
      </form>
    </div>

    <div id="result" class="card" style="display:none"></div>

    <div class="foot muted">åŒ¿åã§ã®ã”å”åŠ›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚å…¥åŠ›å†…å®¹ã¯æ”¹å–„ãƒ»å“è³ªå‘ä¸Šã®ç›®çš„ã§ã®ã¿åˆ©ç”¨ã—ã¾ã™ã€‚</div>
  </div>

  <div class="confetti" id="confetti" aria-hidden="true"></div>

  <script>
    // ====== è¨­å®šï¼šFormspree ã® endpoint ======
    const FORMSPREE_ENDPOINT = "https://formspree.io/f/xdkwdvvj"; // æŒ‡å®šID
    const THANKS_COUPON = "CW100"; // é€ä¿¡å¾Œã®ç‰¹å…¸ã‚³ãƒ¼ãƒ‰ï¼ˆä»»æ„ï¼‰

    // ã‚¹ãƒ†ãƒƒãƒ— / é€²è¡Œ
    const steps = Array.from(document.querySelectorAll('.step'));
    let idx = 0; // ç¾åœ¨ã‚¹ãƒ†ãƒƒãƒ—indexï¼ˆ0é–‹å§‹ï¼‰
    const progress = document.getElementById('progress');
    const buddy = document.getElementById('buddy');
    const capL = document.getElementById('captionLeft');
    const capR = document.getElementById('captionRight');
    const bubble = document.getElementById('bubble');
    const total = steps.length;

    const lines = {
      A:[
        'ã‚ˆã†ã“ãï¼<strong>A</strong>ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã ã‚ˆğŸ§€',
        'ãƒŠã‚¤ã‚¹ï¼ãã®èª¿å­ã€œ',
        'ã‚‚ã†å°‘ã—ã§AãŒçµ‚ã‚ã‚‹ã‚ˆï¼',
        'Aã‚¯ãƒªã‚¢ç›®å‰ï¼æ¬¡ã¯Bã¸âœ¨'
      ],
      B:[
        'Bã«çªå…¥ï¼ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’è©•ä¾¡ã—ã¦ã­ğŸ¢',
        'ã„ã„ã­ï¼æ¬¡ã¯ã‚·ã‚«ã‚´ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ«ğŸ’¦',
        'é †èª¿ã ã‚ˆã€ã‚ã¨å°‘ã—ï¼',
        'æœ€å¾Œã®ç›´ç·šã ã€œï¼',
        'ã‚´ãƒ¼ãƒ«ç›®å‰ï¼é †ä½ã‚’é¸ã‚“ã ã‚‰å®Œäº†ğŸ‰'
      ],
      FIN:'ã‚„ã£ãŸãƒ¼ï¼å›ç­”ã‚ã‚ŠãŒã¨ã†ï¼æ¬¡å›ã¯ã‚‚ã£ã¨æ¥½ã—ããªã‚‹ã‚ˆğŸŠ'
    };

    function sectionLabel(i){ return i<4? 'A. å…¨ä½“è©•ä¾¡' : i<9? 'B. å„ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³' : 'B. å„ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³'; }

    function updateProgress(){
      const pct = Math.round(((idx+1)/total)*100);
      progress.style.width = pct + '%';
      buddy.style.left = pct + '%';
      const remain = total - (idx+1);
      capL.textContent = remain>0 ? `${sectionLabel(idx)} / æ®‹ã‚Š${remain}å•` : 'å®Œäº†ï¼';
      capR.textContent = `${pct}%`;

      // å¹ãå‡ºã—
      if(idx<=3){ bubble.innerHTML = lines.A[idx] || lines.A.at(-1); }
      else if(idx<=8){ bubble.innerHTML = lines.B[idx-4] || lines.B.at(-1); }
      else { bubble.innerHTML = 'ã„ã‚ˆã„ã‚ˆãƒ•ã‚£ãƒ‹ãƒƒã‚·ãƒ¥ï¼ğŸ¯'; }
    }

    function confettiBurst(n=36){
      const root = document.getElementById('confetti');
      for(let i=0;i<n;i++){
        const s = document.createElement('span');
        s.textContent = Math.random()>.4 ? 'ğŸ§€' : (Math.random()>.5?'âœ¨':'â­ï¸');
        s.style.left = Math.random()*100 + 'vw';
        s.style.setProperty('--x', (Math.random()*200-100)+'px');
        s.style.animationDuration = (1.2+Math.random()*0.8)+'s';
        root.appendChild(s);
        setTimeout(()=> s.remove(), 1800);
      }
    }

    function goto(i){
      steps[idx].classList.remove('active');
      idx = i; steps[idx].classList.add('active');
      updateProgress();
      const firstInput = steps[idx].querySelector('input, select, button');
      if(firstInput) firstInput.focus({preventScroll:false});
      window.scrollTo({top:0, behavior:'smooth'});
    }

    document.querySelectorAll('[data-next]').forEach(b=>b.addEventListener('click', ()=>{
      // å¿…é ˆãƒã‚§ãƒƒã‚¯ï¼ˆç°¡æ˜“ï¼‰
      const required = steps[idx].querySelectorAll('[required]');
      for(const el of required){ if(el.type==='radio'){
        const name = el.name; if(!document.querySelector(`input[name="${name}"]:checked`)){ steps[idx].classList.add('error'); setTimeout(()=>steps[idx].classList.remove('error'), 800); return; }
      } else if(el.tagName==='SELECT' && !el.value){ steps[idx].classList.add('error'); setTimeout(()=>steps[idx].classList.remove('error'), 800); return; } }

      // Aå®Œäº†æ™‚ã«å°ã•ã‚ã‚³ãƒ³ãƒ•ã‚§ãƒƒãƒ†ã‚£
      if(idx===3) confettiBurst(24);
      goto(Math.min(idx+1, total-1));
    }));

    document.querySelectorAll('[data-prev]').forEach(b=>b.addEventListener('click', ()=> goto(Math.max(idx-1, 0))));

    // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ— & source
    document.getElementById('timestamp').value = new Date().toISOString();
    const params = new URLSearchParams(location.search);
    document.getElementById('source').value = params.get('ch') || params.get('utm_source') || '';

    // é †ä½é‡è¤‡é˜²æ­¢
    const selects = ['rank1','rank2','rank3'].map(id=>document.getElementById(id));
    function refreshOptions(){
      const chosen = new Set(selects.map(s=>s.value).filter(Boolean));
      selects.forEach(s=>{
        Array.from(s.options).forEach(o=>{ if(!o.value) return; o.disabled = !o.selected && chosen.has(o.value); });
      });
    }
    selects.forEach(s=> s.addEventListener('change', refreshOptions));

    // é€ä¿¡
    const form = document.getElementById('form');
    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const requiredNames = ['csat','nps','rejoin','price_fairness','raclette_slider','chicago_waterfall','melty_dip_pot','cheese_pizza_lab','espuma_basque'];
      for(const n of requiredNames){ if(!form.querySelector(`[name="${n}"]:checked`)){ alert('æœªå›ç­”ã®å¿…é ˆé …ç›®ãŒã‚ã‚Šã¾ã™'); return; } }
      for(const id of ['rank1','rank2','rank3']){ if(!document.getElementById(id).value){ alert('ãŠæ°—ã«å…¥ã‚Šã®é †ä½ã‚’é¸æŠã—ã¦ãã ã•ã„'); return; } }
      const [r1,r2,r3] = selects.map(s=>s.value);
      if(new Set([r1,r2,r3]).size<3){ alert('1ä½ãƒ»2ä½ãƒ»3ä½ã¯é‡è¤‡ã—ãªã„ã‚ˆã†é¸ã‚“ã§ãã ã•ã„'); return; }

      const data = new FormData(form);
      try{
        const res = await fetch(FORMSPREE_ENDPOINT, { method:'POST', body:data, headers:{ 'Accept':'application/json' }});
        if(res.ok){
          document.querySelector('.card').style.display='none';
          const result = document.getElementById('result');
          result.style.display='block';
          result.innerHTML = `
            <h2 style="margin:0 0 6px">ã”å›ç­”ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</h2>
            <p class="muted">${lines.FIN}</p>
            <div class="pill">ç‰¹å…¸ã‚³ãƒ¼ãƒ‰ï¼š<span class="mono"><b>${THANKS_COUPON}</b></span></div>
            <p class="help">â€» æ¬¡å›ä¼šè¨ˆæ™‚ã«ã‚¹ã‚¿ãƒƒãƒ•ã¸ãŠè¦‹ã›ãã ã•ã„ï¼ˆæœŸé–“é™å®šï¼‰ã€‚</p>
          `;
          confettiBurst(60);
          localStorage.setItem('cw_survey_submitted','1');
        } else {
          const payload = await res.json().catch(()=>({}));
          throw new Error(payload?.error || 'é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ™‚é–“ã‚’ç½®ã„ã¦ãŠè©¦ã—ãã ã•ã„ã€‚');
        }
      } catch(err){ alert(err.message); }
    });

    // åˆæœŸè¡¨ç¤º
    function init(){ updateProgress(); refreshOptions(); }
    init();

    // é€ä¿¡æ¸ˆã¿æ™‚ã®è¡¨ç¤º
    if(localStorage.getItem('cw_survey_submitted')==='1'){
      document.querySelector('#result').style.display='block';
      document.querySelector('#result').innerHTML = `<h2>é€ä¿¡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</h2><p class="muted">å†åº¦å›ç­”ã•ã‚Œã‚‹å ´åˆã¯ã€ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚</p>`;
      document.querySelector('.card').style.display='none';
    }
  </script>
</body>
</html>
